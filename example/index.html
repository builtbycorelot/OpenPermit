<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OpenPermit Node Framework Demo</title>
  <style>
    body {
      font-family: system-ui, -apple-system, sans-serif;
      line-height: 1.5;
      margin: 0;
      padding: 20px;
      color: #333;
      max-width: 1000px;
      margin: 0 auto;
    }
    pre {
      background: #f5f5f5;
      padding: 10px;
      border-radius: 4px;
      overflow: auto;
    }
    button {
      background: #0066cc;
      color: white;
      border: none;
      padding: 8px 16px;
      border-radius: 4px;
      cursor: pointer;
      margin-right: 8px;
      margin-bottom: 8px;
    }
    button:hover {
      background: #0052a3;
    }
    .output {
      margin-top: 20px;
    }
    h1 {
      border-bottom: 1px solid #ddd;
      padding-bottom: 10px;
    }
  </style>
</head>
<body>
  <header>
    <h1>OpenPermit Node Framework Demo</h1>
    <p>
      OpenPermit brings the natural, built, and digital environments together so communities can see
      what exists today, plan for what is coming tomorrow, and coordinate rapid responses when
      emergencies strike.
    </p>
  </header>

  <main>
    <section aria-labelledby="layman-overview">
      <h2 id="layman-overview">How it helps everyday residents</h2>
      <p>
        Think of OpenPermit as a shared map and checklist. It pulls in maps and satellite data,
        building models, and live sensor readings so that everyone—from residents to first
        responders—can agree on what is happening in real time. That shared picture makes it easier to
        get building permits approved faster and to understand how a neighborhood is affected when a
        storm or other emergency occurs.
      </p>
    </section>

    <section aria-labelledby="aec-overview">
      <h2 id="aec-overview">For the Architecture, Engineering, and Construction (AEC) community</h2>
      <p>
        Designers and builders can submit BIM deliverables that align with openBIM (IFC) and CityJSON
        standards while linking them directly to GIS parcels, utility models, and job-site IoT feeds.
        The platform normalizes these assets with NIEM and BLDS permit data so multidisciplinary teams
        can automate clash checks, compare existing versus emergency conditions, and keep digital twins
        synchronized with field progress.
      </p>
    </section>

    <section aria-labelledby="policy-overview">
      <h2 id="policy-overview">For policy makers and permitting leaders</h2>
      <p>
        OpenPermit supplies a common data language rooted in NIEM, OGC, ISO 37120, and EPA standards so
        agencies can share evidence, track equity outcomes, and publish transparent dashboards. By
        forming a statewide consortium, jurisdictions can pilot standardized reviews, automate
        cross-agency workflows, and meet statutory reporting or resilience targets without rebuilding
        systems from scratch.
      </p>
    </section>

    <section aria-labelledby="science-overview">
      <h2 id="science-overview">For scientists and digital infrastructure teams</h2>
      <p>
        Researchers can stream environmental sensors, structural health monitors, and climate models
        into a unified knowledge graph. API interfaces follow OData and NIEM exchange patterns so that
        advanced analytics, ML pipelines, and emergency simulations can operate on authoritative data
        with full provenance, supporting rapid situational awareness and after-action reviews.
      </p>
    </section>

    <section aria-labelledby="consortium-call">
      <h2 id="consortium-call">Join the statewide standardization consortium</h2>
      <p>
        We are assembling public agencies, utilities, and academic partners to pilot this integrated
        data standard. Together we can modernize permitting, accelerate housing and infrastructure
        delivery, and strengthen emergency response capabilities across Virginia.
      </p>
    </section>

    <section aria-labelledby="demo-tools">
      <h2 id="demo-tools">Try the data node demo</h2>
      <p>
        Use the buttons below to see how the framework creates requirements, validates submissions, and
        generates crosswalks between standards.
      </p>
      <div>
        <button id="createNodeBtn">Create Node</button>
        <button id="validateNodeBtn">Validate Node</button>
        <button id="createCrosswalkBtn">Create Crosswalk</button>
      </div>

      <div class="output">
        <h3>Output:</h3>
        <pre id="output"></pre>
      </div>
    </section>

    <section aria-labelledby="learn-more">
      <h2 id="learn-more">Learn more</h2>
      <ul>
        <li><a href="./spotsylvania-innovation-sandbox.html">Spotsylvania Innovation Sandbox Call to Action</a></li>
        <li><a href="../docs/public_engagement.md">Public Engagement Program</a></li>
        <li><a href="../docs/outline_infographic.html">Simple Outline (infographic)</a></li>
        <li><a href="../docs/white_paper.md">White Paper</a></li>
        <li><a href="../docs/iso_standard.md">ISO Standard</a></li>
        <li><a href="../docs/technical_explanation.md">Technical Explanation</a></li>
        <li><a href="https://github.com/builtbycorelot/OpenPermit/blob/main/CONTRIBUTING.md">How to contribute</a></li>
        <li><a href="https://github.com/builtbycorelot/OpenPermit?tab=readme-ov-file#stakeholders--how-to-engage">Stakeholder engagement & clarifying details</a></li>
        <li><a href="https://github.com/builtbycorelot/OpenPermit/discussions">Project discussion board</a></li>
      </ul>
    </section>
  </main>
  
  <script src="../src/api/index.js"></script>
  <script>
    // Demo script
    document.addEventListener('DOMContentLoaded', async () => {
      const outputEl = document.getElementById('output');
      const client = new OpenPermit({
        workerPath: '../src/core/worker.js'
      });
      
      // Initialize client
      await client.init();
      
      // Set up button handlers
      document.getElementById('createNodeBtn').addEventListener('click', async () => {
        try {
          outputEl.textContent = 'Creating node...';
          
          const node = await client.createNode({
            id: `node-${Date.now()}`,
            type: 'RequirementNode',
            metadata: {
              name: 'Seismic Requirements for Fire Protection Systems',
              description: 'Requirements for seismic bracing of fire protection systems',
              version: '1.0.0',
              source: 'https://codes.iccsafe.org/content/IBC2021P2',
              domain: 'FireProtection'
            },
            attributes: {
              applicability: 'All Seismic Design Categories C through F',
              codeSection: 'Section 717',
              year: 2021
            }
          });
          
          outputEl.textContent = JSON.stringify(node, null, 2);
        } catch (error) {
          outputEl.textContent = `Error: ${error.message}`;
        }
      });
      
      document.getElementById('validateNodeBtn').addEventListener('click', async () => {
        try {
          outputEl.textContent = 'Validating node...';
          
          // Create a node to validate
          const node = await client.createNode({
            id: `node-${Date.now()}`,
            type: 'RequirementNode',
            metadata: {
              name: 'Seismic Requirements',
              description: 'Requirements for seismic design'
            }
          });
          
          // Validate the node
          const results = await client.validateNode(node);
          
          outputEl.textContent = JSON.stringify(results, null, 2);
        } catch (error) {
          outputEl.textContent = `Error: ${error.message}`;
        }
      });
      
      document.getElementById('createCrosswalkBtn').addEventListener('click', async () => {
        try {
          outputEl.textContent = 'Creating crosswalk...';
          
          // Create source node
          const source = await client.createNode({
            id: `source-${Date.now()}`,
            type: 'StandardNode',
            metadata: {
              name: 'IBC 2021',
              description: 'International Building Code 2021'
            }
          });
          
          // Create target node
          const target = await client.createNode({
            id: `target-${Date.now()}`,
            type: 'StandardNode',
            metadata: {
              name: 'NFPA 13',
              description: 'Standard for the Installation of Sprinkler Systems'
            }
          });
          
          // Create crosswalk
          const crosswalk = await client.createCrosswalk(source, target);
          
          outputEl.textContent = JSON.stringify(crosswalk, null, 2);
        } catch (error) {
          outputEl.textContent = `Error: ${error.message}`;
        }
      });
    });
  </script>
</body>
</html>

